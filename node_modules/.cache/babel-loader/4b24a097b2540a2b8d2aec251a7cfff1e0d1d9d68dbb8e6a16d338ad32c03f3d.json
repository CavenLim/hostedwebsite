{"ast":null,"code":"import{useState,useEffect,useRef,useCallback,forwardRef}from\"react\";import{Box,Spinner,useFormControlProps}from\"@chakra-ui/react\";import*as THREE from\"three\";import{OrbitControls}from'three/examples/jsm/controls/OrbitControls';import{loadGLTFModel}from\"./Model\";import{DogSpinner,DogContainer}from'./VoxelDogLoader';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function easeOutCirc(x){return Math.sqrt(1-Math.pow(x-1,4));}const VoxelDog=()=>{const refContainer=useRef();const[loading,setLoading]=useState(true);const[renderer,setRenderer]=useState();const[_camera,setCamera]=useState();const[target]=useState(new THREE.Vector3(-0.4,1.2,0));//-0.5,1.2,0\nconst[initialCameraPosition]=useState(new THREE.Vector3(0,100,1000));const[scene]=useState(new THREE.Scene());const[_controls,setControls]=useState();useEffect(()=>{const{current:container}=refContainer;if(container&&!renderer){const scW=container.clientWidth;const scH=container.clientHeight;const renderer=new THREE.WebGLRenderer({antialias:true,alpha:true});renderer.setPixelRatio(window.devicePixelRatio);renderer.setSize(window.innerWidth*0.80,640);renderer.outputEncoding=THREE.sRGBEncoding;container.appendChild(renderer.domElement);setRenderer(renderer);const scale=scH*0.005+4.8;const camera=new THREE.OrthographicCamera(-scale,scale,scale,-scale,0.01,10000);camera.position.copy(initialCameraPosition);camera.lookAt(target);setCamera(camera);const ambientLight=new THREE.AmbientLight(0xcccccc,1);scene.add(ambientLight);const controls=new OrbitControls(camera,renderer.domElement);controls.autoRotate=true;controls.target=target;setControls(controls);window.addEventListener('resize',function(){renderer.setSize(window.innerWidth*0.70,560);camera.aspect=window.innerWidth/window.innerHeight;});loadGLTFModel(scene,'/DoggyDone.glb',{receiveShadow:false,castShadow:false}).then(()=>{animate();setLoading(false);controls.enableZoom=false;});let req=null;let frame=0;const animate=()=>{req=requestAnimationFrame(animate);frame=frame<=100?frame+1:frame;if(frame<=100){const p=initialCameraPosition;const rotSpeed=-easeOutCirc(frame/120)*Math.PI*20;camera.position.y=70;camera.position.x=p.x*Math.cos(rotSpeed)+p.z*Math.sin(rotSpeed);camera.position.z=p.z*Math.cos(rotSpeed)-p.x*Math.sin(rotSpeed);camera.lookAt(target);}else{controls.update();}renderer.render(scene,camera);};return()=>{cancelAnimationFrame(req);renderer.dispose();};}},[]);return/*#__PURE__*/_jsxs(DogContainer,{ref:refContainer,children:[loading&&/*#__PURE__*/_jsx(DogSpinner,{}),\" \"]});};export default VoxelDog;","map":{"version":3,"names":["useState","useEffect","useRef","useCallback","forwardRef","Box","Spinner","useFormControlProps","THREE","OrbitControls","loadGLTFModel","DogSpinner","DogContainer","jsx","_jsx","jsxs","_jsxs","easeOutCirc","x","Math","sqrt","pow","VoxelDog","refContainer","loading","setLoading","renderer","setRenderer","_camera","setCamera","target","Vector3","initialCameraPosition","scene","Scene","_controls","setControls","current","container","scW","clientWidth","scH","clientHeight","WebGLRenderer","antialias","alpha","setPixelRatio","window","devicePixelRatio","setSize","innerWidth","outputEncoding","sRGBEncoding","appendChild","domElement","scale","camera","OrthographicCamera","position","copy","lookAt","ambientLight","AmbientLight","add","controls","autoRotate","addEventListener","aspect","innerHeight","receiveShadow","castShadow","then","animate","enableZoom","req","frame","requestAnimationFrame","p","rotSpeed","PI","y","cos","z","sin","update","render","cancelAnimationFrame","dispose","ref","children"],"sources":["/Users/cavenlim/CavenLim site backup/src/Components/VoxelDog.js"],"sourcesContent":["import { useState,useEffect,useRef,useCallback,forwardRef } from \"react\";\nimport { Box,Spinner, useFormControlProps} from \"@chakra-ui/react\";\nimport * as THREE from \"three\";\nimport {OrbitControls} from'three/examples/jsm/controls/OrbitControls';\nimport { loadGLTFModel } from \"./Model\";\nimport { DogSpinner, DogContainer } from './VoxelDogLoader'\n\nfunction easeOutCirc(x){\n    return Math.sqrt(1-Math.pow(x-1,4))\n}\n\nconst VoxelDog = () => {\n    const refContainer = useRef()\n    const [loading,setLoading]=useState(true)\n    const [renderer,setRenderer] = useState()\n    const [_camera,setCamera] = useState()\n    const [target] = useState(new THREE.Vector3(-0.4,1.2,0))//-0.5,1.2,0\n    const [initialCameraPosition] = useState(\n        new THREE.Vector3(0,100,1000\n        )\n    )\n    const [scene] = useState(new THREE.Scene())\n    const [_controls,setControls] = useState()\n\n    useEffect(() =>{\n        const { current:container} = refContainer\n        if(container && !renderer){\n            const scW = container.clientWidth\n            const scH = container.clientHeight\n\n            const renderer = new THREE.WebGLRenderer({\n                antialias:true,\n                alpha:true\n\n            })\n            renderer.setPixelRatio(window.devicePixelRatio)\n            renderer.setSize(window.innerWidth*0.80,640);\n            renderer.outputEncoding = THREE.sRGBEncoding\n            container.appendChild(renderer.domElement)\n            setRenderer(renderer)\n\n            const scale = scH * 0.005 + 4.8\n            const camera = new THREE.OrthographicCamera(\n                -scale,scale,scale,-scale,0.01,10000\n            )\n            camera.position.copy(initialCameraPosition)\n            camera.lookAt(target)\n            setCamera(camera)\n\n            const ambientLight = new THREE.AmbientLight(0xcccccc,1)\n            scene.add(ambientLight)\n\n            const controls = new OrbitControls(camera,renderer.domElement)\n            controls.autoRotate = true\n            controls.target = target\n        \n            setControls(controls)\n            window.addEventListener('resize',function(){\n                renderer.setSize(window.innerWidth*0.70,560);\n                camera.aspect=window.innerWidth/window.innerHeight;\n                \n            \n            })\n\n            loadGLTFModel(scene,'/DoggyDone.glb',{\n                receiveShadow: false,\n                castShadow:false\n\n            }).then(()=>{\n                animate()\n                setLoading(false)\n                controls.enableZoom=false\n                \n            })\n            \n            let req = null\n            let frame = 0\n\n            const animate = () => {\n                req = requestAnimationFrame(animate)\n\n                frame = frame <= 100 ? frame + 1 : frame\n\n                if(frame <= 100){\n                    const p = initialCameraPosition\n                    const rotSpeed = -easeOutCirc(frame/120) * Math.PI * 20\n                    camera.position.y= 70\n                    camera.position.x= p.x * Math.cos(rotSpeed) + p.z * Math.sin(rotSpeed)\n                    camera.position.z= p.z * Math.cos(rotSpeed) - p.x * Math.sin(rotSpeed)\n                    camera.lookAt(target)\n                }else{\n                    controls.update()\n                }\n                renderer.render(scene,camera)\n            }\n            return () =>{\n                cancelAnimationFrame(req)\n                renderer.dispose()\n            }\n        }\n\n    },[])\n\n    return(\n        <DogContainer ref={refContainer}>{loading && <DogSpinner />} </DogContainer>\n    )\n}\nexport default VoxelDog;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}